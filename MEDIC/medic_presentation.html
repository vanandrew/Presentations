<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="author" content="Andrew Van, Dosenbach Lab, Biomedical Engineering">
  <meta name="dcterms.date" content="2023-05-08">
  <title>Thesis Committee Meeting Update</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="https://unpkg.com/reveal.js/dist/reset.css">
  <link rel="stylesheet" href="https://unpkg.com/reveal.js/dist/reveal.css">
  <style>
    .reveal .sourceCode {  /* see #7635 */
      overflow: visible;
    }
    <style>
    :root {
        --r-main-font-size: 24px;
    }
    </style>  </style>
  <link rel="stylesheet" href="https://unpkg.com/reveal.js/dist/theme/black.css" id="theme">
  <style>
  :root {
      --r-main-font-size: 24px;
  }
  </style>
</head>
<body>
  <div class="reveal">
    <div class="slides">

<section id="title-slide">
  <h1 class="title">Thesis Committee Meeting Update</h1>
  <p class="author">Andrew Van, Dosenbach Lab, Biomedical
Engineering</p>
  <p class="date">May 8, 2023</p>
</section>

<section id="todays-agenda" class="slide level2">
<h2>Today’s Agenda</h2>
<ul>
<li>An update on PhD requirements progress
<ul>
<li>Papers (Published and In Progress)</li>
<li>Refresher on Thesis Aims</li>
</ul></li>
<li>Talk about last aim of Thesis
<ul>
<li>Correction of susceptibility-induced distortion with Multi-Echo
Phase Data</li>
</ul></li>
</ul>
</section>
<section id="synth-paper-published" class="slide level2">
<h2>Synth Paper published!</h2>
<p><img data-src="imgs/synth_paper.png" /></p>
</section>
<section id="with-2nd-paper-in-progress" class="slide level2">
<h2>With 2nd paper in progress…</h2>
<p><img data-src="imgs/medic_paper.png" /></p>
<p>Also presenting at ISMRM in June.</p>
</section>
<section id="thesis-aims" class="slide level2">
<h2>Thesis Aims</h2>
<ol type="1">
<li>✅ Apply Synth field map-less EPI distortion correction to diffusion
weighted imaging.</li>
<li>✅ Apply Synth field map-less EPI distortion correction in limited
data settings.</li>
<li><strong>✅ Leverage multi-echo fMRI data to correct susceptibility
distortion.</strong></li>
</ol>
</section>
<section id="overview-of-multi-echo-distortion-correction-medic"
class="slide level2">
<h2>Overview of Multi-Echo DIstortion Correction (MEDIC)</h2>
<ul>
<li>Background on the physics of Echo Planar Imaging (EPI)</li>
<li>Overview of <strong>M</strong>ulti-<strong>E</strong>cho
<strong>DI</strong>stortion <strong>C</strong>orrection (MEDIC)
algorithm</li>
<li>Discussion of MEDIC vs. PEpolar field map results</li>
</ul>
</section>
<section id="echo-planar-imaging-epi-background" class="slide level2">
<h2>Echo Planar Imaging (EPI) Background</h2>
</section>
<section id="echo-planar-imaging-epi" class="slide level2">
<h2>Echo Planar Imaging (EPI)</h2>
<p>A single readout train through k-space:</p>
<p><img data-src="imgs/epi_diagram.png" /></p>
<p>Gradients control readout train.</p>
<p>$$s[k_x, k_y] = \int \int \rho(x,y) e^{-j(k_x(t)x + k_y(t)y)} dx
dy$$</p>
<p>$$k_r(t) = \gamma \int^t G_r(t^{\prime}) dt^{\prime}$$</p>
</section>
<section id="in-the-presence-of-b0-inhomogeneities"
class="slide level2">
<h2>In the presence of B0 inhomogeneities…</h2>
<p>Inhomogeneities add an extra term to the phase:</p>
<p>$$s[k_x, k_y] = \int \int \rho(x,y) e^{-j(\gamma \Delta B_0(x,y) t +
k_x(t)x + k_y(t)y)} dx dy$$</p>
<p>The inhomogeneity term is a spatially varying phase roll, which has
the following effect on the signal (assuming readout direction x and
phase-encoding direction y):</p>
<p>$$\rho(x - (\gamma \Delta B_0(x,y) \tau_{dwell}), y - ({\gamma}
\Delta B_0(x,y) \tau_{readout}))$$</p>
<p>where $\tau_{dwell}$ is the time between k-space samples and
$\tau_{readout}$ is the time between the first and last echoes of the
readout train. Since $\tau_{dwell}$ is very small, distortion in readout
is negligible, but $\tau_{readout}$ is large enough to see significant
distortion in phase encoding direction.</p>
</section>
<section id="an-example" class="slide level2">
<h2>An example</h2>
<figure>
<img data-src="imgs/distortion_simulation.png"
alt="Simulation of distortion effects caused by B0 inhomogeneities." />
<figcaption aria-hidden="true">Simulation of distortion effects caused
by B0 inhomogeneities.</figcaption>
</figure>
</section>
<section id="correcting-for-distortion-caused-by-b0-inhomogeneities"
class="slide level2">
<h2>Correcting for distortion caused by B0 inhomogeneities</h2>
<p>Correcting distortion requires measuring $\gamma \Delta B_0(x,y)$
(i.e. field map).</p>
<p>Two approaches:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">Phase Difference</th>
<th style="text-align: center;">PEpolar</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img
data-src="imgs/phase_difference.png" /></td>
<td style="text-align: center;"><img data-src="imgs/rpe.png" /></td>
</tr>
</tbody>
</table>
<p>The <strong>M</strong>ulti-<strong>E</strong>cho
<strong>DI</strong>stortion <strong>C</strong>orrection (MEDIC)
algorithm uses the phase difference approach.</p>
</section>
<section id="some-background-on-medic" class="slide level2">
<h2>Some Background on MEDIC</h2>
</section>
<section id="what-is-medic" class="slide level2">
<h2>What is MEDIC?</h2>
<p>MEDIC is an algorithm that extracts field maps from the phase
information of multi-echo EPI data. This removes the need for a separate
field map acquisition:</p>
<div class="r-stack">
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/traditional_fmap.png"
alt="Example of Reverse Phase Encode Acquisition. Field mapping is done before/after a BOLD run." />
<figcaption aria-hidden="true">Example of Reverse Phase Encode
Acquisition. Field mapping is done before/after a BOLD run.</figcaption>
</figure>
</div>
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/medic_fmap.png"
alt="In MEDIC, field maps are computed from the phase information of ME-EPI, which allows for measurement of the field frame-to-frame." />
<figcaption aria-hidden="true">In MEDIC, field maps are computed from
the phase information of ME-EPI, which allows for measurement of the
field frame-to-frame.</figcaption>
</figure>
</div>
</div>
</section>
<section id="relationship-between-echo-time-phase-and-the-field-map"
class="slide level2">
<h2>Relationship between echo time, phase and the field map</h2>
<p>The slope of the relationship between phase and echo time is the
field map:</p>
<p>$$\phi(x,y) = \gamma \Delta B_0(x,y) t_{echo}$$</p>
<p>For $n$ echoes, we want to find $\gamma \Delta B_0(x,y)$ that
satisfies the equation:</p>
<p>$$\begin{bmatrix} \phi_1(x,y) \\ \phi_2(x,y) \\ \vdots \\ \phi_n(x,y)
\end{bmatrix} = \gamma \Delta B_0(x,y) \begin{bmatrix} t_{1} \\ t_{2} \\
\vdots \\ t_{n} \end{bmatrix}$$</p>
</section>
<section id="in-practice" class="slide level2">
<h2>In Practice…</h2>
</section>
<section id="practical-issue-1-phase-wraps" class="slide level2">
<h2>Practical Issue 1: Phase wraps</h2>
<p>Raw phase measurements collected off the scanner are wrapped between
$-\pi$ and $\pi$:</p>
<figure>
<img data-src="imgs/wrapped_phase.png"
alt="Wrapped phase from 1st echo of ME-EPI data." />
<figcaption aria-hidden="true">Wrapped phase from 1st echo of ME-EPI
data.</figcaption>
</figure>
</section>
<section id="practical-issue-2-phase-offsets" class="slide level2">
<h2>Practical Issue 2: Phase offsets</h2>
<p>The linear model assumes phase $\phi(x,y) = 0$ if $t = 0$. This is
not true in practice due to off-resonance effects in the receiver coils.
A more realistic model would be:</p>
<p>$$\begin{bmatrix} \phi_1(x,y) \\ \phi_2(x,y) \\ \vdots \\ \phi_n(x,y)
\end{bmatrix} = \gamma \Delta B_0(x,y) \begin{bmatrix} t_{1} \\ t_{2} \\
\vdots \\ t_{n} \end{bmatrix} + \phi_{offset}(x,y)$$</p>
<p>where $\phi_{offset}(x,y)$ is a spatially dependent phase offset.</p>
</section>
<section id="practical-issue-3-non-uniqueness" class="slide level2">
<h2>Practical Issue 3: Non-uniqueness</h2>
<p>$$\begin{bmatrix} \phi_1(x,y) + 2\pi N_1 \\ \phi_2(x,y) + 2\pi N_2 \\
\vdots \\ \phi_n(x,y) + 2\pi N_n \end{bmatrix} = \gamma \Delta B_0(x,y)
\begin{bmatrix} t_{1} \\ t_{2} \\ \vdots \\ t_{n} \end{bmatrix}$$</p>
<p>From the perspective of phase, there is no difference between a phase
value of $\phi$ and some $2\pi$ multiple offset of it (i.e. $\phi + 2\pi
N$). This means that there is no unique solution to the above
equation.</p>
</section>
<section id="assumptions" class="slide level2">
<h2>Assumptions</h2>
<p>To solve these issues, we make the following assumptions:</p>
<ol type="1">
<li>The phase is spatially smooth.</li>
<li>Phase evolves linearly with time.</li>
<li>The global accumulation of phase at the 1st echo is low (more
specifically between $[-\pi, \pi]$).</li>
<li>Frames with similar head positions have similar unwrapped phase
values.</li>
</ol>
</section>
<section id="how-does-medic-work" class="slide level2">
<h2>How does MEDIC work?</h2>
</section>
<section id="step-1-correcting-phase-offsets-and-unwrapping"
class="slide level2">
<h2>Step 1: Correcting phase offsets and unwrapping</h2>
<p>Two algorithms:</p>
<p><strong>M</strong>ulti-<strong>C</strong>hannel
<strong>P</strong>hase <strong>C</strong>8ombination using measured
<strong>3D</strong> phase offsets, <strong>S</strong>implified
(MCPC-3D-S): For phase offset correction</p>
<p><strong>R</strong>apid <strong>O</strong>pensource
<strong>M</strong>inimum spanning tre<strong>E</strong>
alg<strong>O</strong>rithm (ROMEO): For phase unwrapping</p>
</section>
<section id="step-1a-phase-offset-correction-using-mcpc-3d-s"
class="slide level2">
<h2>Step 1a: Phase offset correction using MCPC-3D-S</h2>
<p>MCPC-3D-S removes phase offsets through estimating an unwrapped phase
difference between 1st and 2nd echoes and predicting the phase offset
(assuming linear phase evolution).</p>
<div class="r-stack">
<div class="fragment fade-out" data-fragment-index="0">
<figure>
<img data-src="imgs/pre_phase_offset_correction.png"
alt="Without phase offset correction, phase unwrapping cannot find consistent solutions" />
<figcaption aria-hidden="true">Without phase offset correction, phase
unwrapping cannot find consistent solutions</figcaption>
</figure>
</div>
<div class="fragment current-visible" data-fragment-index="0">
<figure>
<img data-src="imgs/phase_offset.png"
alt="Computed phase offset which are removed from all echos" />
<figcaption aria-hidden="true">Computed phase offset which are removed
from all echos</figcaption>
</figure>
</div>
<div class="fragment">
<figure>
<img data-src="imgs/post_phase_offset_correction.png"
alt="Phase Unwrapping after phase offset correction" />
<figcaption aria-hidden="true">Phase Unwrapping after phase offset
correction</figcaption>
</figure>
</div>
</div>
</section>
<section id="step-1b-phase-unwrapping-using-romeo" class="slide level2">
<h2>Step 1b: Phase unwrapping using ROMEO</h2>
<p>ROMEO unwraps phase through a path based unwrapping algorithm
(Prim-Jarník algorithm). The path is detemined through several quality
metrics, all based around varying smoothness criterion on the
values/gradients of the phase/magnitude images. ROMEO imposes a linear
constraint on the unwrapping solutions of phase across echoes.</p>
<div class="r-stack">
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/phase1.png" alt="Echo 1 Wrapped (14.2 ms)" />
<figcaption aria-hidden="true">Echo 1 Wrapped (14.2 ms)</figcaption>
</figure>
</div>
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/echo1.png" alt="Echo 1 Unwrapped (14.2 ms)" />
<figcaption aria-hidden="true">Echo 1 Unwrapped (14.2 ms)</figcaption>
</figure>
</div>
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/phase2.png" alt="Echo 2 Wrapped (38.93 ms)" />
<figcaption aria-hidden="true">Echo 2 Wrapped (38.93 ms)</figcaption>
</figure>
</div>
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/echo2.png" alt="Echo 2 Unwrapped (38.93 ms)" />
<figcaption aria-hidden="true">Echo 2 Unwrapped (38.93 ms)</figcaption>
</figure>
</div>
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/phase3.png" alt="Echo 3 Wrapped (63.66 ms)" />
<figcaption aria-hidden="true">Echo 3 Wrapped (63.66 ms)</figcaption>
</figure>
</div>
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/echo3.png" alt="Echo 3 Unwrapped (63.66 ms)" />
<figcaption aria-hidden="true">Echo 3 Unwrapped (63.66 ms)</figcaption>
</figure>
</div>
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/phase4.png" alt="Echo 4 Wrapped (88.39 ms)" />
<figcaption aria-hidden="true">Echo 4 Wrapped (88.39 ms)</figcaption>
</figure>
</div>
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/echo4.png" alt="Echo 4 Unwrapped (88.39 ms)" />
<figcaption aria-hidden="true">Echo 4 Unwrapped (88.39 ms)</figcaption>
</figure>
</div>
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/phase5.png" alt="Echo 5 Wrapped (113.12 ms)" />
<figcaption aria-hidden="true">Echo 5 Wrapped (113.12 ms)</figcaption>
</figure>
</div>
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/echo5.png" alt="Echo 5 Unwrapped (113.12 ms)" />
<figcaption aria-hidden="true">Echo 5 Unwrapped (113.12 ms)</figcaption>
</figure>
</div>
</div>
<p>Phase unwrapping solutions for each echo.</p>
</section>
<section id="step-2-global-mode-offset-correction-gmoc"
class="slide level2">
<h2>Step 2: Global mode offset correction (GMOC)</h2>
<p>As previously mentioned, unwrapping solutions are non-unique. We can
force uniqueness by assuming that the modal global accumulation of phase
at the first echo is within the range $-\pi$ and $\pi$, then imposing a
linear constraint for all subsequent echoes to find the unique
solution.</p>
<div class="r-stack">
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/pre_gmoc_timeseries.png"
alt="Example of unwrapping solutions settling on $2\pi$ offset away from other solutions." />
<figcaption aria-hidden="true">Example of unwrapping solutions settling
on $2\pi$ offset away from other solutions.</figcaption>
</figure>
</div>
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/pre_gmoc_correction.png"
alt="Bad solution in question." />
<figcaption aria-hidden="true">Bad solution in question.</figcaption>
</figure>
</div>
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/post_gmoc_correction.png"
alt="After Global mode offset correction." />
<figcaption aria-hidden="true">After Global mode offset
correction.</figcaption>
</figure>
</div>
</div>
</section>
<section id="step-3-temporal-correction" class="slide level2">
<h2>Step 3: Temporal Correction</h2>
<p>GMOC fixes most unwrap errors, but operates globally (all voxels).
Local errors are fixed by Temporal Correction.</p>
<p>For each TR, compare the phase unwrapping solutions for TRs where the
head is positioned similarly (Correlational Similarity of &gt;0.98).
Then for each voxel, compute any $2\pi$ multiple offsets that would make
the phase unwrapping solutions close to the mean.</p>
<figure>
<img data-src="imgs/pre_gmoc_timeseries.png"
alt="Example of unwrapping solutions settling on $2\pi$ offset away from other solutions." />
<figcaption aria-hidden="true">Example of unwrapping solutions settling
on $2\pi$ offset away from other solutions.</figcaption>
</figure>
<p>This step has the greatest effect for voxels where SNR is low.</p>
</section>
<section id="step-4-computing-the-field-map" class="slide level2">
<h2>Step 4: Computing the field map</h2>
<p>The field map is computed by using weighted least squares:</p>
<p>$$ W_{mag} \boldsymbol{\phi} = W_{mag} \gamma \Delta B_0 \mathbf{t}
$$</p>
<p>where $W_{mag}$ is the magnitude at each echo.</p>
</section>
<section id="step-5-svd-filtering" class="slide level2">
<h2>Step 5: SVD Filtering</h2>
<p>To remove temporal noise components, an SVD filtering step is applied
to the field map (voxels x time) and small singular values from the data
are removed.</p>
<video width="720" height="480" controls loop>
<source src="videos/svd.mp4" type="video/mp4">
</video>
</section>
<section id="step-6-inverting-the-field-map" class="slide level2">
<h2>Step 6: Inverting the field map</h2>
<p>Field maps computed on ME-EPI data are in the distorted space, so we
must invert the field map to get it into the undistorted space:</p>
<p>$$y_{undistorted} = y_{distorted} - \Delta r(x, y_{distorted})$$</p>
<p>The field map is converted into a displacement field, then the ITK
library <code>InvertDisplacementFieldImageFilter</code> is used to
invert the field. The inverted displacement field is then converted back
into a field map.</p>
<div class="r-stack">
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/fmap_native.png"
alt="Field map in distorted space." />
<figcaption aria-hidden="true">Field map in distorted
space.</figcaption>
</figure>
</div>
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/fmap.png" alt="Field map in undistorted space." />
<figcaption aria-hidden="true">Field map in undistorted
space.</figcaption>
</figure>
</div>
</div>
</section>
<section id="results" class="slide level2">
<h2>Results</h2>
</section>
<section id="datasets" class="slide level2">
<h2>Datasets</h2>
<ul>
<li>CMRR Multi-Echo EPI Sequence
<ul>
<li>TR: 1.761 s, TEs: 14.2, 38.93, 63.66, 88.39, 113.12 ms, 72 Slices,
FOV: 110x110, Voxel Size: 2.0 mm, Multi-Band: 6</li>
</ul></li>
<li>Spin Echo PEpolar Field maps
<ul>
<li>TR: 8 s, TE: 66 ms, 72 Slices, FOV: 110x110, Voxel Size: 2.0mm</li>
<li>Field map solutions computed with FSL TOPUP</li>
</ul></li>
<li>T1w/T2w Anatomical Scans
<ul>
<li>T1w: Multiecho MPRAGE, TR: 2.5 s, TEs: 1.81, 3.6, 5.39, 7.18 ms, 208
Slices, FOV: 300x300, Voxel Size: 0.8 mm, Bandwidth: 745 Hz/px</li>
<li>T2w: T2 SPACE, TR: 3.2, TE: 565 ms, 176 Slices, Turbo Factor: 190,
FOV: 256x256, Voxel Size: 1 mm, Bandwidth: 240 Hz/px</li>
</ul></li>
<li>Datasets (Resting State Only)
<ul>
<li>Midnight Scan Club (N=1)</li>
<li>ASD/ADHD Dataset (N=21)</li>
<li>UPenn preliminary data (N=1)</li>
</ul></li>
</ul>
</section>
<section
id="medic-correction-has-greater-correspondence-to-cortical-anatomy-than-pepolar-correction"
class="slide level2">
<h2>MEDIC correction has greater correspondence to cortical anatomy than
PEpolar correction</h2>
<div class="r-stack">
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/anatomical_align/UPenn_medic.png"
alt="UPenn: MEDIC corrected" />
<figcaption aria-hidden="true">UPenn: MEDIC corrected</figcaption>
</figure>
</div>
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/anatomical_align/UPenn_topup.png"
alt="UPenn: PEpolar (TOPUP) corrected" />
<figcaption aria-hidden="true">UPenn: PEpolar (TOPUP)
corrected</figcaption>
</figure>
</div>
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/anatomical_align/MSCHD02_medic.png"
alt="MSC: MEDIC corrected" />
<figcaption aria-hidden="true">MSC: MEDIC corrected</figcaption>
</figure>
</div>
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/anatomical_align/MSCHD02_topup.png"
alt="MSC: PEpolar (TOPUP) corrected" />
<figcaption aria-hidden="true">MSC: PEpolar (TOPUP)
corrected</figcaption>
</figure>
</div>
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/anatomical_align/NP1173_medic.png"
alt="ASD/ADHD: MEDIC corrected" />
<figcaption aria-hidden="true">ASD/ADHD: MEDIC corrected</figcaption>
</figure>
</div>
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/anatomical_align/NP1173_topup.png"
alt="ASD/ADHD: PEpolar (TOPUP) corrected" />
<figcaption aria-hidden="true">ASD/ADHD: PEpolar (TOPUP)
corrected</figcaption>
</figure>
</div>
</div>
</section>
<section
id="medic-correction-has-greater-correspondence-to-anatomy-than-pepolar-correction"
class="slide level2">
<h2>MEDIC correction has greater correspondence to anatomy than PEpolar
correction</h2>
<div class="r-stack">
<div class="element: fragment current-visible">
<p>Global alignment metrics (whole brain) for ASD/ADHD Dataset. ✅
indicates best metric that was statistically significant (p &lt; 0.05).
Correlation metric is the Pearson correlation between the functional and
anatomical data. Grad. Corr. is the Pearson correlation between the
gradient of the functional and anatomical data. Norm. MI is the
normalized mutual information between the functional and anatomical
data.</p>
<table>
<colgroup>
<col style="width: 22%" />
<col style="width: 27%" />
<col style="width: 19%" />
<col style="width: 10%" />
<col style="width: 11%" />
<col style="width: 7%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Metric</th>
<th style="text-align: center;">MEDIC</th>
<th style="text-align: center;">TOPUP</th>
<th style="text-align: center;">t-stat</th>
<th style="text-align: center;">p-value</th>
<th style="text-align: center;">df</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">T1w Correlation</td>
<td style="text-align: center;">✅<strong>0.412 (0.052)</strong></td>
<td style="text-align: center;">0.403 (0.052)</td>
<td style="text-align: center;">15.430</td>
<td style="text-align: center;">&lt; 0.001</td>
<td style="text-align: center;">182</td>
</tr>
<tr class="even">
<td style="text-align: center;">T2w Correlation</td>
<td style="text-align: center;">0.710 (0.025)</td>
<td style="text-align: center;">0.711 (0.030)</td>
<td style="text-align: center;">-0.991</td>
<td style="text-align: center;">0.323</td>
<td style="text-align: center;">182</td>
</tr>
<tr class="odd">
<td style="text-align: center;">T1w Grad. Corr.</td>
<td style="text-align: center;">✅<strong>0.432 (0.040)</strong></td>
<td style="text-align: center;">0.417 (0.039)</td>
<td style="text-align: center;">8.526</td>
<td style="text-align: center;">&lt; 0.001</td>
<td style="text-align: center;">182</td>
</tr>
<tr class="even">
<td style="text-align: center;">T2w Grad. Corr.</td>
<td style="text-align: center;">0.667 (0.034)</td>
<td style="text-align: center;">0.664 (0.055)</td>
<td style="text-align: center;">1.184</td>
<td style="text-align: center;">0.238</td>
<td style="text-align: center;">182</td>
</tr>
<tr class="odd">
<td style="text-align: center;">T1w Norm. MI</td>
<td style="text-align: center;">✅<strong>0.081 (0.006)</strong></td>
<td style="text-align: center;">0.079 (0.006)</td>
<td style="text-align: center;">11.146</td>
<td style="text-align: center;">&lt; 0.001</td>
<td style="text-align: center;">182</td>
</tr>
<tr class="even">
<td style="text-align: center;">T2w Norm. MI</td>
<td style="text-align: center;">✅<strong>0.099 (0.007)</strong></td>
<td style="text-align: center;">0.098 (0.008)</td>
<td style="text-align: center;">4.018</td>
<td style="text-align: center;">&lt; 0.001</td>
<td style="text-align: center;">182</td>
</tr>
</tbody>
</table>
</div>
<div class="element: fragment current-visible">
<p>Local alignment metrics (whole brain) for ASD/ADHD Dataset. ✅
indicates best metric that was statistically significant (p &lt; 0.05).
Spotlight analysis was performed by computing the average local
correlation between the functional and anatomical images across all
voxels within a 3 voxel sphere.</p>
<table>
<colgroup>
<col style="width: 22%" />
<col style="width: 27%" />
<col style="width: 19%" />
<col style="width: 10%" />
<col style="width: 11%" />
<col style="width: 7%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Metric</th>
<th style="text-align: center;">MEDIC</th>
<th style="text-align: center;">TOPUP</th>
<th style="text-align: center;">t-stat</th>
<th style="text-align: center;">p-value</th>
<th style="text-align: center;">df</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">T1w Spotlight</td>
<td style="text-align: center;">✅<strong>0.347 (0.019)</strong></td>
<td style="text-align: center;">0.340 (0.019)</td>
<td style="text-align: center;">9.031</td>
<td style="text-align: center;">&lt; 0.001</td>
<td style="text-align: center;">182</td>
</tr>
<tr class="even">
<td style="text-align: center;">T2w Spotlight</td>
<td style="text-align: center;">✅<strong>0.521 (0.035)</strong></td>
<td style="text-align: center;">0.514 (0.044)</td>
<td style="text-align: center;">4.329</td>
<td style="text-align: center;">&lt; 0.001</td>
<td style="text-align: center;">182</td>
</tr>
</tbody>
</table>
</div>
<div class="element: fragment current-visible">
<p>Task based metrics for ASD/ADHD Dataset. ✅ indicates best metric
that was statistically significant (p &lt; 0.05). Each metric examined
the separability of tissue types using anatomical segmentation labels
applied to functional data. Separability was measured by thresholding
the functional data along the tissue boundary, comparing the
classification against the anatomical segmenation, and computing the AUC
of the resulting ROC curve.</p>
<table>
<colgroup>
<col style="width: 22%" />
<col style="width: 27%" />
<col style="width: 19%" />
<col style="width: 10%" />
<col style="width: 11%" />
<col style="width: 7%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Metric</th>
<th style="text-align: center;">MEDIC</th>
<th style="text-align: center;">TOPUP</th>
<th style="text-align: center;">t-stat</th>
<th style="text-align: center;">p-value</th>
<th style="text-align: center;">df</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Brain/Exterior</td>
<td style="text-align: center;">✅<strong>0.754 (0.034)</strong></td>
<td style="text-align: center;">0.748 (0.032)</td>
<td style="text-align: center;">12.265</td>
<td style="text-align: center;">&lt; 0.001</td>
<td style="text-align: center;">182</td>
</tr>
<tr class="even">
<td style="text-align: center;">Gray/White</td>
<td style="text-align: center;">✅<strong>0.689 (0.034)</strong></td>
<td style="text-align: center;">0.686 (0.037)</td>
<td style="text-align: center;">3.461</td>
<td style="text-align: center;">&lt; 0.001</td>
<td style="text-align: center;">182</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Ventricle/White</td>
<td style="text-align: center;">0.837 (0.056)</td>
<td style="text-align: center;">0.835 (0.059)</td>
<td style="text-align: center;">1.473</td>
<td style="text-align: center;">0.142</td>
<td style="text-align: center;">182</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="field-map-comparison" class="slide level2">
<h2>Field Map Comparison</h2>
<div class="r-stack">
<div class="element: fragment current-visible">
<p>If the MEDIC field map is able to more accurately measure field
inhomogeneities (due to greater correspondence to anatomy), where does
the error in the PEpolar method come from? Two possibilities:</p>
<ol type="1">
<li>PEpolar method fails to accurately capture the true field map.</li>
<li>Functional data contains other off-resonance effects that are not
captured by the PEpolar field map</li>
</ol>
<p>How to distinguish the two? Compare against a 3rd field map
method.</p>
</div>
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/fieldmap_compare.png"
alt="Comparison of Field Map from FLASH (ROMEO), PEpolar EPI (TOPUP), and ME-EPI (MEDIC) data." />
<figcaption aria-hidden="true">Comparison of Field Map from FLASH
(ROMEO), PEpolar EPI (TOPUP), and ME-EPI (MEDIC) data.</figcaption>
</figure>
</div>
<div class="element: fragment current-visible">
<p>Comparison of ME-EPI data to GRE PEpolar field map shows additional
off-resonance effects in ME-EPI data.</p>
<figure>
<img data-src="imgs/se_upenn_fmap.png"
alt="Spin Echo PEpolar Image (UPenn)" />
<figcaption aria-hidden="true">Spin Echo PEpolar Image
(UPenn)</figcaption>
</figure>
</div>
<div class="element: fragment current-visible">
<p>Comparison of ME-EPI data to GRE PEpolar field map shows additional
off-resonance effects in ME-EPI data.</p>
<figure>
<img data-src="imgs/gre_upenn_fmap.png"
alt="Gradient Echo PEpolar Image (UPenn)" />
<figcaption aria-hidden="true">Gradient Echo PEpolar Image
(UPenn)</figcaption>
</figure>
</div>
<div class="element: fragment current-visible">
<p>Comparison of ME-EPI data to GRE PEpolar field map shows additional
off-resonance effects in ME-EPI data.</p>
<figure>
<img data-src="imgs/me_epi_upenn_fmap.png"
alt="ME-EPI Image, 1st Echo (UPenn)" />
<figcaption aria-hidden="true">ME-EPI Image, 1st Echo
(UPenn)</figcaption>
</figure>
</div>
</div>
</section>
<section id="tsnr-comparison" class="slide level2">
<h2>tSNR Comparison</h2>
<div class="r-stack">
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/tSNR.png" style="width:70.0%"
alt="tSNR comparison between TOPUP and MEDIC (MSC)." />
<figcaption aria-hidden="true">tSNR comparison between TOPUP and MEDIC
(MSC).</figcaption>
</figure>
</div>
<div class="element: fragment current-visible">
<p>In ASD/ADHD dataset, tSNR was not significantly different between
MEDIC and TOPUP corrected data.</p>
<table>
<colgroup>
<col style="width: 21%" />
<col style="width: 26%" />
<col style="width: 21%" />
<col style="width: 10%" />
<col style="width: 11%" />
<col style="width: 7%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Metric</th>
<th style="text-align: center;">MEDIC</th>
<th style="text-align: center;">TOPUP</th>
<th style="text-align: center;">t-stat</th>
<th style="text-align: center;">p-value</th>
<th style="text-align: center;">df</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">tSNR</td>
<td style="text-align: center;">38.993 (16.130)</td>
<td style="text-align: center;">39.345 (16.166)</td>
<td style="text-align: center;">-1.747</td>
<td style="text-align: center;">0.082</td>
<td style="text-align: center;">182</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="medic-can-measure-field-changes-due-to-head-position."
class="slide level2">
<h2>MEDIC can measure field changes due to head position.</h2>
<div class="r-stack">
<div class="fragment current-visible">
<video width="720" height="480" controls loop>
<source src="videos/rot-X.mp4" type="video/mp4">
</video>
<p>
-X Rotation
</p>
</div>
<div class="fragment current-visible">
<video width="720" height="480" controls loop>
<source src="videos/rot+X.mp4" type="video/mp4">
</video>
<p>
+X Rotation
</p>
</div>
<div class="fragment current-visible">
<video width="720" height="480" controls loop>
<source src="videos/rot-Y.mp4" type="video/mp4">
</video>
<p>
-Y Rotation
</p>
</div>
<div class="fragment current-visible">
<video width="720" height="480" controls loop>
<source src="videos/rot+Y.mp4" type="video/mp4">
</video>
<p>
+Y Rotation
</p>
</div>
<div class="fragment current-visible">
<video width="720" height="480" controls loop>
<source src="videos/rot-Z.mp4" type="video/mp4">
</video>
<p>
-Z Rotation
</p>
</div>
<div class="fragment current-visible">
<video width="720" height="480" controls loop>
<source src="videos/rot+Z.mp4" type="video/mp4">
</video>
<p>
+Z Rotation
</p>
</div>
<div class="fragment current-visible">
<video width="720" height="480" controls loop>
<source src="videos/trans-Z.mp4" type="video/mp4">
</video>
<p>
-Z Translation
</p>
</div>
</div>
</section>
<section id="medic-corrections-account-for-head-motion-effects."
class="slide level2">
<h2>MEDIC corrections account for head motion effects.</h2>
<div class="r-stack">
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/motion_distortion_correction/medic_rotation_+y.png"
alt="Rotation +Y: MEDIC Corrected" />
<figcaption aria-hidden="true">Rotation +Y: MEDIC Corrected</figcaption>
</figure>
</div>
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/motion_distortion_correction/topup_rotation_+y.png"
alt="Rotation +Y: PEpolar (TOPUP) Corrected" />
<figcaption aria-hidden="true">Rotation +Y: PEpolar (TOPUP)
Corrected</figcaption>
</figure>
</div>
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/motion_distortion_correction/medic_rotation_-z.png"
alt="Rotation -Z: MEDIC Corrected" />
<figcaption aria-hidden="true">Rotation -Z: MEDIC Corrected</figcaption>
</figure>
</div>
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/motion_distortion_correction/topup_rotation_-z.png"
alt="Rotation -Z: PEpolar (TOPUP) Corrected" />
<figcaption aria-hidden="true">Rotation -Z: PEpolar (TOPUP)
Corrected</figcaption>
</figure>
</div>
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/motion_distortion_correction/medic_rotation_+z.png"
alt="Rotation +Z: MEDIC Corrected" />
<figcaption aria-hidden="true">Rotation +Z: MEDIC Corrected</figcaption>
</figure>
</div>
<div class="element: fragment current-visible">
<figure>
<img data-src="imgs/motion_distortion_correction/topup_rotation_+z.png"
alt="Rotation +Z: PEpolar (TOPUP) Corrected" />
<figcaption aria-hidden="true">Rotation +Z: PEpolar (TOPUP)
Corrected</figcaption>
</figure>
</div>
</div>
</section>
<section id="conclusions" class="slide level2">
<h2>Conclusions</h2>
<div class="r-stack">
<div class="element: fragment current-visible">
<ul>
<li>MEDIC provides superior distortion correction performance over
PEpolar (i.e. TOPUP) method.
<ul>
<li>Mainly driven by more accurate accounting of field
inhomogeneities.</li>
</ul></li>
<li>MEDIC field maps are coupled in space and time to functional data.
<ul>
<li>No need for co-registeration of field map to functional data.</li>
<li>Removes separate sequence for field map acquisition.</li>
<li>Can account for field changes due to head motion.</li>
</ul></li>
</ul>
</div>
<div class="element: fragment current-visible">
<ul>
<li>Algorithmic Limitations
<ul>
<li>Suffers from same limitation as phase difference field map methods
<ul>
<li>Requires accurate measurement of phase at two echoes, but areas of
very high susceptibility have significant signal loss at later echo
times.</li>
</ul></li>
</ul></li>
<li>Study limitations
<ul>
<li>Only tested on a single ME-EPI protocol</li>
</ul></li>
<li>Future work
<ul>
<li>Test on other ME-EPI protocols as more ME-EPI datasets become
available.</li>
<li>Modified MEDIC for Bipolar ME acquisitions can allow reduction in
time between echoes.</li>
</ul></li>
</ul>
</div>
</div>
</section>
    </div>
  </div>

  <script src="https://unpkg.com/reveal.js/dist/reveal.js"></script>

  <!-- reveal.js plugins -->
  <script src="https://unpkg.com/reveal.js/plugin/notes/notes.js"></script>
  <script src="https://unpkg.com/reveal.js/plugin/search/search.js"></script>
  <script src="https://unpkg.com/reveal.js/plugin/zoom/zoom.js"></script>
  <script src="https://unpkg.com/reveal.js/plugin/math/math.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: true,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'bottom-right',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: true,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: false,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: true,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'default',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: true,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        math: {
          mathjax: '',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['$','$']],
            displayMath: [['$$','$$']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [
          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    </body>
</html>
